<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Medic Diagnosis Bot</title>
<style>
  :root {
    --accent: #0b84ff;
    --user-bg: rgba(11,132,255,0.2); /* semi-transparent user bubble */
    --assist-bg: rgba(0,0,0,0.35);   /* semi-transparent bot bubble */
  }
  html, body {
    height:100%;
    margin:0;
    background:transparent !important; /* no solid background */
    font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;
  }
  .wrap {
    display:flex;
    flex-direction:column;
    height:100%;
    min-height:300px;
    gap:8px;
    padding:12px;
    box-sizing:border-box;
    background:transparent !important; /* force transparency */
  }
  .chat {
    flex:1;
    overflow:auto;
    padding:8px;
    display:flex;
    flex-direction:column;
    gap:8px;
    background:transparent !important; /* transparent behind bubbles */
  }
  .row { display:flex; max-width:90%; align-items:flex-end; }
  .row.user { justify-content:flex-end; margin-left:auto; }
  .bubble {
    padding:10px 12px;
    border-radius:12px;
    line-height:1.35;
    word-wrap:break-word;
    box-shadow:0 1px 0 rgba(0,0,0,0.06);
  }
  .bubble.user {
    background:#0088a0;
    color:#fff;
    border-bottom-right-radius:6px;
  }
  .bubble.assist {
    background:#808080;
    color:#fff;
    border-bottom-left-radius:6px;
    backdrop-filter: blur(4px);
  }
  .inputRow { display:flex; gap:8px; background:transparent !important; }
  textarea {
    flex:1;
    min-height:44px;
    max-height:140px;
    resize:vertical;
    padding:8px;
    border-radius:8px;
    border:1px solid rgba(255,255,255,0.3);
    background:#EEEEEE;
    color:#000; /* black text inside textarea */
  }
  button {
    background:#0088a0;
    color:#fff;
    border:none;
    padding:10px 14px;
    border-radius:8px;
    cursor:pointer;
  }
  button[disabled]{opacity:.6;cursor:not-allowed}
</style>
</head>
<body>
  <div class="wrap">
    <div style="display:flex;justify-content:space-between;align-items:center;">
      <strong style="color:#808080">Medic Bot</strong>
      <span style="color:#808080" id="info"></span>
    </div>

    <div id="chat" class="chat"></div>
    <div id="status" style="font-size:12px;color:#ccc;"></div>

    <div class="inputRow">
      <textarea id="msg" placeholder="Type your message..."></textarea>
      <button id="send">Send</button>
    </div>
  </div>

<script>
(async function(){
  const API_URL = "https://apifreellm.com/api/chat";
  const chat = document.getElementById('chat');
  const msg = document.getElementById('msg');
  const sendBtn = document.getElementById('send');
  const status = document.getElementById('status');

  function addMessage(text, who){
    const row = document.createElement('div');
    row.className = 'row ' + (who === 'user' ? 'user' : 'assist');
    const bubble = document.createElement('div');
    bubble.className = 'bubble ' + (who === 'user' ? 'user' : 'assist');
    bubble.textContent = text;
    row.appendChild(bubble);
    chat.appendChild(row);
    chat.scrollTop = chat.scrollHeight;
  }

  async function callApi(message){
    const res = await fetch(API_URL, {
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body: JSON.stringify({ message })
    });
    const data = await res.json();
    if(data.status === 'success'){
      return data.response;
    } else {
      throw new Error(data.response || 'API error');
    }
  }

  async function send(){
    const text = msg.value.trim();
    if(!text) return;
    msg.value = '';
    addMessage(text,'user');
    addMessage('â€¦','assist');
    const typing = chat.lastChild;
    try {
      const reply = await callApi(text);
      typing.remove();
      addMessage(reply,'assist');
    } catch(e){
      typing.remove();
      addMessage('Error: ' + e.message,'assist');
    }
  }

  sendBtn.onclick = send;
  msg.addEventListener('keydown', e => {
    if(e.key==='Enter' && !e.shiftKey){
      e.preventDefault();
      send();
    }
  });
})();
</script>
</body>
</html>
